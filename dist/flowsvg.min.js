/* flowSVG - v0.3.0 - 2023-10-13*/
/*global SVG, console, window, document, jQuery*/
var flowSVG=function(){"use strict";var d,a,t,l,v,c,h,s,g,u,n,r,x={},f=!0,b={},y={},p={},w=[],N=[],H=!0,m=!0,S=0,O=0,P=0;function k(o){var e="0,0 "+v.arrowHeadHeight+",0 "+v.arrowHeadHeight/2+","+v.arrowHeadHeight;return o.polygon(e).fill({color:v.arrowHeadColor,opacity:v.arrowHeadOpacity}).cx(v.arrowHeadHeight/2).cy(v.arrowHeadHeight/2)}function C(o,e){var e=e.group(),i=e.rect(v.labelWidth,v.labelHeight).radius(v.labelRadius).stroke({width:v.labelStroke}).attr({opacity:v.labelOpacity,fill:v.labelFill});return i.move(-v.labelWidth/2,v.labelHeight/2),e.text(o).attr({fill:v.labelTextColour,"text-anchor":"middle","font-size":v.labelFontSize}).cy(i.cy()),e}function L(e){var i,o,t,n,r=d.group().attr({class:"fc-start"}),s=r.rect(v.startWidth,v.startHeight).attr({fill:v.startFill,"stroke-width":v.startStrokeWidth,stroke:v.startStrokeWidth}).radius(v.startCornerRadius);return r.id(),u=r.attr("id"),o=d.group(),t=k(o).move(-v.arrowHeadHeight/2,v.connectorLength-v.arrowHeadHeight),n=d.line(0,0,0,v.connectorLength-v.arrowHeadHeight).attr({"stroke-width":v.connectorStrokeWidth,stroke:v.connectorStrokeColour}),o.add(n).add(t),a=o,n=r.text(function(o){o.tspan(v.startText).newLine().attr({"text-anchor":"middle","font-size":v.startFontSize,fill:v.startTextColour})}),t=s.bbox(),a.move(t.cx-a.bbox().width/2,t.height),n.move(t.cx-n.bbox().width/2),n.cy(t.cy),r.add(a),!0===f&&(r.attr({cursor:"pointer"}),r.click(function(){var o=e[0].svgid;if(!1===e[0].show)e[0].show=!0,o.animate().opacity(v.maxOpacity),o.attr("visibility","visible");else{for(o.animate().opacity(v.minOpacity),o.attr("visibility","hidden"),e[0].show=!1,i=0;i<N.length;i+=1)e[p[N[i]]].svgid.animate().opacity(v.minOpacity),e[p[N[i]]].show=!1,e[p[N[i]]].svgid.attr("visibility","hidden");N.splice(0,N.length-1)}})),r}function B(o){h=(d=o).group()}function F(){var o,e,i,t=d.group().attr({cursor:"pointer"}),n=(v.startWidth-5)/2,r=t.rect(n,v.btnBarHeight).fill(v.startFill).radius(v.btnBarRadius);return t.text("Interactive").attr({fill:v.startTextColour,"font-size":v.btnBarFontSize,"pointer-events":"none"}).cy(v.btnBarHeight/2).cx(n/2),o=t.rect(n,v.btnBarHeight).fill(v.startFill).radius(v.btnBarRadius).move(5+n,0),t.text("Static").attr({fill:v.startTextColour,"font-size":v.btnBarFontSize,"pointer-events":"none"}).cy(v.btnBarHeight/2).cx(1.5*n+5),!0===f&&r.fill(v.btnBarSelectedColour),!1===f&&o.fill(v.btnBarSelectedColour),e=r.attr("fill"),i=o.attr("fill"),r.on("mouseover",function(){r.fill({color:v.btnBarHoverColour})}).on("mouseout",function(){r.fill({color:e})}).on("click",function(){f=!0,r.fill(v.btnBarSelectedColour),o.fill(v.startFill),d.clear(),f=!0,B(d),s(c)}).on("mousedown",function(){r.fill(v.btnBarSelectedColour)}),o.on("mouseover",function(){o.fill({color:v.btnBarHoverColour})}).on("mouseout",function(){o.fill({color:i})}).on("click",function(){f=!1,o.fill(v.btnBarSelectedColour),r.fill(v.startFill),d.clear(),f=!1,B(d),s(c)}).on("mousedown",function(){o.fill(v.btnBarSelectedColour)}),t}function W(o,e){if(!o.type||"function"!=typeof t[o.type])return console.log(o.type+" is not a valid shape."),!1;var i=t[o.type](o);i.id(),o.id=i.attr("id"),o.svgid=i,o.svgshape=i.get(0),b[o.label]=o.id,y[o.id]=e,!1===f?(o.show=!0,i.opacity(v.maxOpacity)):(o.show=!1,i.attr("visibility","hidden"),i.opacity(v.minOpacity))}function z(o){o.yes&&(o.yesid=b[o.yes],o.svgyesid=SVG("#"+b[o.yes])),o.no&&(o.noid=b[o.no],o.svgnoid=SVG("#"+b[o.no])),o.next&&(o.nextid=b[o.next],o.svgnextid=SVG("#"+b[o.next]))}function E(o){var e;o.orient||(o.orient={yes:"b",no:"r",next:"b"}),o.yes&&(e=p[o.yes],c[e])&&(c[e].previd=o.id,c[e].prev=o.label,c[e].svgprevid=SVG("#"+o.id),"b"===o.orient.yes&&(c[e].isBelow=o.id,c[e].svgisBelow=SVG("#"+o.id)),"l"===o.orient.yes&&(c[e].isLeftOf=o.id,c[e].svgisLeftOf=SVG("#"+o.id)),"r"===o.orient.yes)&&(c[e].isRightOf=o.id,c[e].svgisRightOf=SVG("#"+o.id)),o.no&&(e=p[o.no],c[e])&&(c[e].previd=o.id,c[e].prev=o.label,c[e].svgprevid=SVG("#"+o.id),"b"!==o.orient.no&&!o.placeNoBelow||(c[e].isBelow=o.id,c[e].svgisBelow=SVG("#"+o.id)),"r"===o.orient.no)&&(c[e].isRightOf=o.id,c[e].svgisRightOf=SVG("#"+o.id)),o.next&&(e=p[o.next],c[e])&&(c[e].previd=o.id,c[e].prev=o.label,c[e].svgprevid=SVG("#"+o.id),"b"===o.orient.next&&(c[e].isBelow=o.id,c[e].svgisBelow=SVG("#"+o.id)),"l"===o.orient.next&&(c[e].isLeftOf=o.id,c[e].svgisLeftOf=SVG("#"+o.id)),"r"===o.orient.next)&&(c[e].isRightOf=o.id,c[e].svgisRightOf=SVG("#"+o.id))}function R(i,o){var t=0,n=i.svgid.bbox();return n.cx&&o.forEach(o=>{var e=o.svgid.bbox();o!==i&&e.x&&e.x<=n.x2&&e.y<=n.y2&&e.x2>=n.x&&e.y2>=n.y&&(i.isBelow?t+=e.height+v.connectorLength:t+=e.width+v.connectorLength)}),t}function T(o,e,i){var t,n,r,s,d=o.svgid;0===e&&(o.isBelow=u,o.svgisBelow=SVG("#"+u)),t=void 0!==o.placeNoBeside,n=void 0!==o.placeNoBelow,s=(void 0!==o.isRightOf|void 0!==o.isLeftOf|t)&!n,n=(void 0!==o.isBelow|n)&!t,t=o.svgisBelow||o.svgisRightOf||o.svgisLeftOf,o.placeNoBelow&&(o.orient.no="l"),o.inNode||(o.isBelow?o.inNode="t":o.isRightOf&&(o.inNode="l")),n?(n=t.y()+t.bbox().height,0!==e&&(n+=v.connectorLength),d.move(t.x(),n),(r=R(o,i))&&(n+=r,d.move(t.x(),n),o.overlapShift=r),n>d.node.ownerSVGElement.clientHeight&&(e=n+t.bbox().height,t.node.ownerSVGElement.setAttribute("height",e)),S<n&&(P=(S=n)+t.bbox().height+v.connectorLength)):s&&(e=!1===f&&void 0!==o.moveRight?o.moveRight:v.connectorLength,n=t.x()+t.bbox().width+e,d.move(n,t.y()),(r=R(o,i))&&(d.move(n+=r,t.y()),o.overlapShift=r),n>d.node.ownerSVGElement.clientWidth)&&(s=n+t.bbox().width,t.node.ownerSVGElement.setAttribute("width",s))}function M(o,e){var i;o.isBelow||o.isRightOf||o.isLeftOf||(o=o.svgid,O+o.bbox().width>o.node.ownerSVGElement.clientWidth&&(O=0,P+=o.bbox().height+v.connectorLength),P>o.node.ownerSVGElement.clientHeight&&(i=P+o.bbox().height,o.node.ownerSVGElement.setAttribute("height",i)),o.move(O,P),O+=o.bbox().width+v.connectorLength)}function G(o){for(var e,i=o;i<N.length;i+=1)(e=c[p[N[i]]]).show=!1,e.svgid.animate().opacity(v.minOpacity),e.svgid.attr("visibility","hidden");N.splice(o,N.length)}function Y(o){var e,i,t=o.svgid,n=h.group();o.yes&&void 0!==o.yesid&&(e=o.svgyesid,"t"===(i=c[p[o.yes]]).inNode&&(i.inNodePos=[e.cx(),e.y()]),"b"===o.orient.yes&&(o.yesOutPos=[t.cx(),t.bbox().y2],i.inNode=void 0!==i.inNode?i.inNode:"t","l"===i.inNode)&&(i.inNodePos=[e.x()-v.arrowHeadHeight,e.cy()]),"r"===o.orient.yes&&(o.yesOutPos=[t.bbox().x2,t.cy()],i.inNode=void 0!==i.inNode?i.inNode:"l","l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),w.push(o.yesid)),o.no&&void 0!==o.noid&&(i=c[p[o.no]],e=o.svgnoid,"l"===o.orient.no&&(o.noOutPos=[t.bbox().x,t.cy()],i.inNode=void 0!==i.inNode?i.inNode:"l",i.inNodePos="l"==i.inNode?[e.x(),e.cy()]:[e.cx(),e.y()]),"b"===o.orient.no&&(o.noOutPos=[t.cx(),t.bbox().y2],i.inNode=void 0!==i.inNode?i.inNode:"t",i.inNodePos=[e.cx(),e.y()]),"r"===o.orient.no&&(o.noOutPos=[t.bbox().x2,t.cy()],i.inNode=void 0!==i.inNode?i.inNode:"l","t"===i.inNode&&(i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),w.push(o.noid)),o.next&&(i=c[p[o.next]],"b"===o.orient.next&&(o.nextOutPos=[t.cx(),t.bbox().y2],i.inNode=void 0!==i.inNode?i.inNode:"t","t"===i.inNode&&(e=o.svgnextid,i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(e=o.svgnoid,i.inNodePos=[e.x(),e.cy()]),"l"===o.orient.next&&(o.nextOutPos=[t.bbox().x,t.bbox().cy],i.inNode=void 0!==i.inNode?i.inNode:"l",e=o.svgnextid,"t"===i.inNode&&(i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),"r"===o.orient.next&&(o.nextOutPos=[t.bbox().x2,t.bbox().cy],i.inNode=void 0!==i.inNode?i.inNode:"l",e=o.svgnextid,"t"===i.inNode&&(i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),w.push(o.nextid)),n.back(),o.conngroup=n}function j(o){var e,i,t=o.svgshape;o.yes&&void 0!==o.yesid&&(e=c[p[o.yes]].svgshape,"t"===(i=c[p[o.yes]]).inNode&&(i.inNodePos=[e.cx(),e.y()]),"b"===o.orient.yes&&(o.yesOutPos=[t.cx(),t.y()+t.bbox().height],i.inNode=void 0!==i.inNode?i.inNode:"t","l"===i.inNode)&&(i.inNodePos=[e.x()-v.arrowHeadHeight,e.cy()]),"r"===o.orient.yes&&(o.yesOutPos=[t.x()+t.width(),t.cy()],i.inNode=void 0!==i.inNode?i.inNode:"l","l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),w.push(o.yesid)),o.no&&void 0!==o.noid&&(i=c[p[o.no]],e=c[p[o.no]].svgshape,"b"===o.orient.no&&(o.noOutPos=[t.cx(),t.y()+t.bbox().height],i.inNode=void 0!==i.inNode?i.inNode:"t",i.inNodePos=[e.cx(),e.y()]),"r"===o.orient.no&&(o.noOutPos=[t.x()+t.bbox().width,t.cy()],i.inNode=void 0!==i.inNode?i.inNode:"l","t"===i.inNode&&(i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),"l"===o.orient.no&&(o.noOutPos=[t.cx(),t.y()],i.inNode=void 0!==i.inNode?i.inNode:"l","t"===i.inNode&&(i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),w.push(o.noid)),o.next&&(i=c[p[o.next]],"b"===o.orient.next&&(o.nextOutPos=[t.cx(),t.bbox().height+t.y()],i.inNode=void 0!==i.inNode?i.inNode:"t","t"===i.inNode&&(e=c[p[o.next]].svgshape,i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(e=o.svgnoid,i.inNodePos=[e.x(),e.cy()]),"r"===o.orient.next&&(o.nextOutPos=[t.x()+t.bbox().width,t.cy()],i.inNode=void 0!==i.inNode?i.inNode:"l",e=c[p[o.next]].svgshape,"t"===i.inNode&&(i.inNodePos=[e.cx(),e.y()]),"l"===i.inNode)&&(i.inNodePos=[e.x(),e.cy()]),w.push(o.nextid))}function A(o){var e,i=o.svgid;o.yes&&void 0!==o.yesid&&(e=C(v.labelYes,i),(o.yesBtn=e).attr("cursor","pointer"),e.on("click",function(){n(o,"yes")}),"b"===o.orient.yes&&e.move(o.yesOutPos[0],o.yesOutPos[1]+v.labelNudgeBottom),"r"===o.orient.yes)&&e.move(o.yesOutPos[0]+20+v.labelNudgeRight,o.yesOutPos[1]-20),o.no&&void 0!==o.noid&&(e=C(v.labelNo,i),(o.noBtn=e).attr("cursor","pointer"),e.on("click",function(){n(o,"no")}),"b"===o.orient.no&&e.move(o.noOutPos[0]+v.labelNudgeBottom,o.noOutPos[1]),"r"===o.orient.no&&e.move(o.noOutPos[0]+20+v.labelNudgeRight,o.noOutPos[1]-20),"l"===o.orient.no)&&e.move(o.noOutPos[0]-20-v.labelNudgeRight,o.noOutPos[1]+20)}function I(o){var e,i=o.conngroup;o.yes&&void 0!==o.yesid&&(e=C(v.labelYes,i),"b"===o.orient.yes&&e.move(o.yesOutPos[0],o.yesOutPos[1]),"r"===o.orient.yes)&&e.move(o.yesOutPos[0]+20+v.labelNudgeRight,o.yesOutPos[1]-20),o.no&&void 0!==o.noid&&(e=C(v.labelNo,i),"b"===o.orient.no&&e.move(o.noOutPos[0],o.noOutPos[1]),"r"===o.orient.no&&e.move(o.noOutPos[0]+20+v.labelNudgeRight,o.noOutPos[1]-20),"l"===o.orient.no)&&e.move(o.noOutPos[0]-20-v.labelNudgeRight,o.noOutPos[1]+20)}function Q(o){var e,i=o.svgid,t=o.svgshape.x()-v.arrowHeadHeight,n=o.svgshape.cy(),r=o.svgshape.x()+o.svgshape.bbox().width+v.connectorLength-v.arrowHeadHeight,s=o.svgshape.cy()-v.arrowHeadHeight/2,d=o.svgshape.cx()-v.arrowHeadHeight/2,a=o.svgshape.y()+o.svgshape.bbox().height+v.connectorLength-v.arrowHeadHeight;void 0!==o.svgyesid&&("r"===o.orient.yes&&((e=k(i)).move(r,s),e.rotate(270)),"b"===o.orient.yes)&&(e=k(i)).move(d,a),void 0!==o.svgnoid&&("l"===o.orient.no&&((e=k(i)).move(t,n),e.rotate(90)),"r"===o.orient.no&&((e=k(i)).move(r,s),e.rotate(270)),"b"===o.orient.no)&&(e=k(i)).move(d,a),void 0!==o.svgnextid&&("r"===o.orient.next&&((e=k(i)).move(r,s),e.rotate(270)),"b"===o.orient.next)&&(e=k(i)).move(d,a)}function q(o){var e,i,t=o.conngroup;o.yes&&void 0!==o.yesid&&(e=k(t),i=c[p[o.yes]],"b"===o.orient.yes&&(e.move(i.inNodePos[0]-v.arrowHeadHeight/2,i.inNodePos[1]-v.arrowHeadHeight),"l"===i.inNode)&&e.rotate(270),"r"===o.orient.yes)&&(e.move(i.inNodePos[0]-v.arrowHeadHeight/2,i.inNodePos[1]-v.arrowHeadHeight),"l"===i.inNode)&&(e.move(i.inNodePos[0]-v.arrowHeadHeight,i.inNodePos[1]-v.arrowHeadHeight/2),e.rotate(270)),o.no&&void 0!==o.noid&&(e=k(t),i=c[p[o.no]],"b"!==o.orient.no&&"l"!==o.orient.no||e.move(i.inNodePos[0]-v.arrowHeadHeight/2,i.inNodePos[1]-v.arrowHeadHeight),"r"===o.orient.no)&&(e.move(i.inNodePos[0]-v.arrowHeadHeight,i.inNodePos[1]-v.arrowHeadHeight/2),"l"===i.inNode&&e.rotate(270),"t"===i.inNode)&&e.move(i.inNodePos[0]-v.arrowHeadHeight/2,i.inNodePos[1]-v.arrowHeadHeight),o.next&&void 0!==o.nextid&&(e=k(t),i=c[p[o.next]],"b"===o.orient.next&&(e.move(i.inNodePos[0]-v.arrowHeadHeight/2,i.inNodePos[1]-v.arrowHeadHeight),"l"===i.inNode)&&e.rotate(270),"r"===o.orient.next)&&(e.move(i.inNodePos[0]-v.arrowHeadHeight,i.inNodePos[1]-v.arrowHeadHeight/2),e.rotate(270))}function V(o,e,i,t,n){var r,s,d,a,l,c,h=i.svgshape,g=2*v.arrowHeadHeight;if(o[1]===h.y()+h.height())return n?(l=5*v.connectorLength/4,c=+v.connectorLength/4,o[1]<e[1]?[o,r=[o[0],o[1]+c],s=[o[0]+l,o[1]+c],d=[o[0]+l,e[1]-c-v.arrowHeadHeight],[e[0],e[1]-c-v.arrowHeadHeight],e]:[o,r=[o[0]+l,o[1]],s=[o[0]+l,o[1]+c],d=[e[0]-l-v.arrowHeadHeight,o[1]+c],[e[0]-l-v.arrowHeadHeight,o[1]],e]):(s=[(r=o)[0],o[1]+g],e[1]>o[1]&&(s=[o[0],e[1]-g],d=[e[0],e[1]-g]),e[0]<o[0]&&(d=[e[0],e[1]-g]),[r,s,d=e[1]<=o[1]?[e[0],e[1]+g]:d,a=[e[0],e[1]-v.arrowHeadHeight]]);if(o[0]<e[0]&&o[1]>e[1])return[r=o,s=[o[0]+g,o[1]],d=[o[0]+g,e[1]-g],[e[0],e[1]-g],a=[e[0],e[1]-v.arrowHeadHeight]];if(o[0]>e[0]&&o[1]<e[1])return[r=o,s=[o[0]+g,o[1]],d=[o[0]+g,e[1]-v.shapeHeight/2-g],[e[0]-g,e[1]-v.shapeHeight/2-g],[e[0]-g,e[1]],a=[e[0],e[1]]];if(o[0]<e[0]&&o[1]<e[1]){h=i.svgid,i=SVG("#"+t);if(e[1]>i.y())return[r=o,s=[o[0]+g/2,o[1]],d=[o[0]+g/2,e[1]],a=[e[0]-v.arrowHeadHeight,e[1]]];if(e[1]===i.y())return h.x()==o[0]?[r=o,r,s=[o[0]-g/2,o[1]],d=[o[0]-g/2,e[1]-v.arrowHeadHeight-g/2],[e[0],e[1]-v.arrowHeadHeight-g/2],[e[0],e[1]-v.arrowHeadHeight]]:[r=o,s=[e[0],o[1]],a=[e[0],e[1]-v.arrowHeadHeight]]}return o[1]<e[1]?a=[e[0],e[1]-v.arrowHeadHeight]:o[0]<e[0]&&(a=[e[0]-v.arrowHeadHeight,e[1]]),n?(l=+v.connectorLength/4,c=5*v.connectorLength/4,o[1],e[1],[o,r=[o[0]+l,o[1]],s=[o[0]+l,o[1]+c],d=[e[0]-l-v.arrowHeadHeight,o[1]+c],[e[0]-l-v.arrowHeadHeight,o[1]],a]):[o,a]}function D(o){var e,i;o.yesid&&(e=o.yesOutPos,"b"===o.orient.yes&&(i=[e[0],e[1]+v.connectorLength]),"r"===o.orient.yes&&(i=[e[0]+v.connectorLength,e[1]]),o.svgid.polyline(V(e,i,o)).stroke({width:v.connectorStrokeWidth,color:v.connectorStrokeColour}).fill("none")),o.noid&&(e=o.noOutPos,"b"===o.orient.no&&(i=[e[0],e[1]+v.connectorLength]),"r"===o.orient.no&&(i=[e[0]+v.connectorLength,e[1]]),"l"===o.orient.no&&(i=[e[0]-v.connectorLength,e[1]]),o.svgid.polyline(V(e,i,o)).stroke({width:v.connectorStrokeWidth,color:v.connectorStrokeColour}).fill("none")),o.nextid&&(e=o.nextOutPos,"b"===o.orient.next&&(i=[e[0],e[1]+v.connectorLength]),void 0===(i="r"===o.orient.next?[e[0]+v.connectorLength,e[1]]:i)&&(i=c[p[o.next]].yesOutPos),o.svgid.polyline(V(e,i,o)).stroke({width:v.connectorStrokeWidth,color:v.connectorStrokeColour}).fill("none"))}function J(o){var e,i,t;o.yesid&&(e=o.yesOutPos,i=c[p[o.yes]].inNodePos,t=c[p[o.yes]].overlapShift,o.conngroup.polyline(V(e,i,o,o.yesid,t)).stroke({width:v.connectorStrokeWidth,color:v.connectorStrokeColour}).fill("none")),o.noid&&(e=o.noOutPos,i=c[p[o.no]].inNodePos,t=c[p[o.no]].overlapShift,o.conngroup.polyline(V(e,i,o,o.noid,t)).stroke({width:v.connectorStrokeWidth,color:v.connectorStrokeColour}).fill("none")),o.nextid&&(e=o.nextOutPos,i=c[p[o.next]].inNodePos,t=c[p[o.next]].overlapShift,void 0===i&&(i=c[p[o.next]].yesOutPos),o.conngroup.polyline(V(e,i,o,o.nextid,t)).stroke({width:v.connectorStrokeWidth,color:v.connectorStrokeColour}).fill("none"))}return t={decision:function(o){var t,n,r=h.group(),e="0,"+v.decisionHeight/2+" "+v.decisionWidth/2+",0 "+v.decisionWidth+","+v.decisionHeight/2+" "+v.decisionWidth/2+","+v.decisionHeight,e=r.polygon(e).attr({fill:v.decisionFill,class:"fc-rhombus"});return r.attr("class","fc-decision"),(t=r.text(function(e){o.text.forEach(function(o){e.tspan(o).newLine().attr("text-anchor","middle")})})).fill(v.decisionTextColour).font({size:v.decisionFontSize}),t.cx(e.cx()+t.bbox().width/2+t.bbox().x),t.cy(e.cy()),o.links&&o.links.forEach(function(o){var e=d.link(o.url),i=d.text(o.text);e.add(i),o.target&&e.target(o.target),i.fill(v.finishLinkColour).font({size:v.finishFontSize}),o=t.bbox(),n=i.bbox(),i.dmove(o.cx-n.cx,o.y2+15),r.add(e)}),r},finish:function(i){var o,e,t,n=h.group().attr({class:"finish-group"}),r=n.rect(v.finishWidth,v.finishHeight).attr({fill:v.finishFill,class:"fc-finish"}).radius(20),s=n.group();return s.text(function(e){i.text.forEach(function(o){e.tspan(o).newLine()})}).fill(v.finishTextColour).font({size:v.finishFontSize}),i.links&&i.links.forEach(function(o){var e=d.link(o.url),i=d.text(o.text);e.add(i),o.target&&e.target(o.target),i.fill(v.finishLinkColour).font({size:v.finishFontSize}),o=s.bbox(),i.dmove(0,o.height+5),s.add(e)}),i.tip&&((o=n.text(i.tip.title).fill(v.finishLinkColour).font({size:v.finishFontSize}).attr("cursor","pointer")).move(v.finishLeftMargin,r.height()-25),o.on("mouseover",function(){e=n.group(),t=n.text(function(e){i.tip.text.forEach(function(o){e.tspan(o).newLine()})}).font({size:v.tipFontSize}).move(v.tipMarginLeft,v.tipMarginTop);e.rect(v.shapeWidth-v.finishLeftMargin,t.bbox().height+2*v.tipMarginTop).attr({fill:v.tipFill,stroke:v.tipStrokeColour,class:"fc-tip"}),e.add(t),e.x(v.finishLeftMargin/2),e.bbox();var o=r.height()-e.bbox().height-30;e.y(o)}).on("mouseout",function(){e.remove()})),s.move(v.finishLeftMargin,(r.height()-s.bbox().height)/2-5),n},process:function(o){var e=h.group().attr({class:"process-group"}),i=e.rect(v.processWidth,v.processHeight).attr({fill:v.processFill,stroke:v.processStrokeColour,class:"fc-process"}),t=e.group();return t.text(function(e){o.text.forEach(function(o){e.tspan(o).newLine()})}).font({size:v.processFontSize}),o.links&&o.links.forEach(function(o){var e=d.link(o.url),i=d.text(o.text);e.add(i),o.target&&e.target(o.target),i.fill(v.processLinkColour).font({size:v.processFontSize}),o=t.bbox(),i.dmove(0,o.height+5),t.add(e)}),t.move(v.finishLeftMargin,(i.height()-t.bbox().height)/2-5),e}},n=function(o,e){var i,t,n;if("yes"===e){if(!0===c[p[o.yes]].show&&!1===c[p[o.no]].show)return G(i=N.indexOf(o.yes)),void(n=o.id);-1<(i=N.indexOf(o.no))&&G(i),-1===N.indexOf(o.yes)&&N.push(o.yes),"b"===o.orient.yes&&(o.svgyesid.move(o.svgid.x(),o.svgid.y()+o.svgid.bbox().height),void 0!==c[p[o.yes]].svgnextid)&&c[p[o.yes]].svgnextid.move(o.svgyesid.x(),o.svgyesid.bbox().y+o.svgyesid.bbox().height),"r"===o.orient.yes&&(o.svgyesid.move(o.svgid.x()+o.svgid.bbox().width,o.svgid.y()),void 0!==c[p[o.yes]].svgnextid)&&c[p[o.yes]].svgnextid.move(o.svgyesid.x(),o.svgyesid.bbox().y+o.svgyesid.bbox().height),o.svgyesid.animate().opacity(v.maxOpacity),n=o.yesid,o.svgyesid.attr("visibility","visible"),c[p[o.yes]].show=!0,c[p[o.no]].svgid.animate().opacity(v.minOpacity),c[p[o.no]].svgid.attr("visibility","hidden"),c[p[o.no]].show=!1,void 0!==c[p[o.yes]].next&&(t=c[p[o.yes]].next,N.push(t),c[p[t]].svgid.animate().opacity(v.maxOpacity),c[p[t]].svgid.attr("visibility","visible"),c[p[t]].show=!0,n=c[p[t]].id)}if("no"===e){if(!0===c[p[o.no]].show)return G(i=N.indexOf(o.no)),void(n=o.id);-1<(i=N.indexOf(o.yes))&&G(i),-1===N.indexOf(o.no)&&N.push(o.no),"b"===o.orient.no&&(o.svgnoid.move(o.svgid.x(),o.svgid.y()+o.svgid.bbox().height),void 0!==c[p[o.no]].svgnextid)&&c[p[o.no]].svgnextid.move(o.svgnoid.x(),o.svgnoid.bbox().y+o.svgnoid.bbox().height),"r"===o.orient.no&&(o.svgnoid.move(o.svgid.x()+o.svgid.bbox().width,o.svgid.y()),void 0!==c[p[o.no]].svgnextid)&&c[p[o.no]].svgnextid.move(o.svgnoid.x(),o.svgnoid.bbox().y+o.svgnoid.bbox().height),"l"===o.orient.no&&(o.svgnoid.move(o.svgid.x(),o.svgid.y()),void 0!==c[p[o.no]].svgnextid)&&c[p[o.no]].svgnextid.move(o.svgnoid.x(),o.svgnoid.bbox().y),o.svgnoid.animate().opacity(v.maxOpacity),n=o.noid,o.svgnoid.attr("visibility","visible"),c[p[o.no]].show=!0,void 0!==c[p[o.no]].next&&(t=c[p[o.no]].next,N.push(t),c[p[t]].show=!0,c[p[t]].svgid.animate().opacity(v.maxOpacity),c[p[t]].svgid.attr("visibility","visible"),n=c[p[t]].id)}!0===m&&(e=window.innerHeight,i=d.attr("id"),o=document.getElementById(i),t=document.getElementById(n),i=SVG(n).bbox(),n=o.createSVGPoint(),t=t.getCTM(),e<(n=n.matrixTransform(t).y+i.height+o.parentNode.offsetTop+20+r))&&(window.jQuery&&window.jQuery.scrollTo?jQuery.scrollTo(n-e,1e3):window.scrollTo(0,n-e))},{config:function(o){f=void 0===(x=o).interactive||x.interactive,H=void 0===x.showButtons||x.showButtons,m=void 0===x.scrollto||x.scrollto,r=void 0!==x.scrollOffset?x.scrollOffset:0},draw:B,shapes:s=function(o){var e,i,t,n,r,s;for(c=o,o=x.w||180,i=x.h||140,t=x.arrowColour||"grey",n="rgb(66, 66, 66)",r="#fff",s=x.defaultFontSize||12,v={showButtons:x.showButtons||!0,minOpacity:x.minOpacity||0,maxOpacity:x.maxOpacity||1,btnBarHeight:x.btnBarHeight||40,btnBarSelectedColour:x.btnBarSelectedColour||"black",btnBarHoverColour:x.btnBarHoverColour||"dimgrey",btnBarFontSize:x.btnBarFontSize||s,btnBarRadius:x.btnBarRadius||10,shapeWidth:x.shapeWidth||o,shapeHeight:x.shapeHeight||i,connectorLength:x.connectorLength||80,startWidth:x.startWidth||o,startHeight:x.startHeight||40,startCornerRadius:x.startCornerRadius||20,startFill:x.startFill||t,startStrokeWidth:x.startStrokeWidth||.1,startStrokeColour:x.startStrokeColour||"rgb(66, 66, 66)",startTextColour:x.startTextColour||r,startText:x.startText||"Start",startFontSize:x.startFontSize||s,decisionWidth:x.decisionWidth||x.w||o,decisionHeight:x.decisionHeight||x.h||i,decisionFill:x.decisionFill||"#8b3572",decisionTextColour:x.decisionTextColour||r,decisionFontSize:x.decisionFontSize||s,finishTextColour:x.finishTextColour||r,finishWidth:x.finishWidth||o,finishHeight:x.finishHeight||i,finishLeftMargin:x.finishLeftMargin||20,finishFill:x.finishFill||"#0F6C7E",finishFontSize:x.finishFontSize||s,finishLinkColour:x.finishLinkColour||"yellow",processWidth:x.processWidth||o,processHeight:x.processHeight||i,processLeftMargin:x.processLeftMargin||20,processFill:x.processFill||"#fff",processStrokeColour:x.processStrokeColour||n,processStrokeWidth:x.processStrokeWidth||.1,processTextColour:x.processTextColour||"rgb(51, 51, 51)",processFontSize:x.processFontSize||s,processLinkColour:x.processLinkColour||"darkblue",labelWidth:x.labelWidth||30,labelHeight:x.labelHeight||20,labelRadius:x.labelRadius||5,labelStroke:x.labelStroke||.1,labelFill:x.labelFill||t,labelOpacity:x.labelOpacity||1,labelFontSize:x.labelFontSize||s,labelTextColour:x.labelTextColour||r,labelYes:x.labelYes||"Yes",labelNo:x.labelNo||"No",labelNudgeRight:x.labelNudgeRight||0,labelNudgeBottom:x.labelNudgeBottom||0,arrowHeadHeight:x.arrowHeadHeight||20,arrowHeadColor:x.arrowHeadColor||t,arrowHeadOpacity:x.arrowHeadOpacity||1,connectorStrokeWidth:x.connectorStrokeWidth||1.5,connectorStrokeColour:x.connectorStrokeColour||t,tipStrokeColour:x.tipStrokeColour||n,tipStrokeWidth:x.tipStrokeWidth||.1,tipFill:x.tipFill||"#fff",tipFontSize:x.tipFontSize||s,tipMarginTop:x.tipMarginTop||10,tipMarginLeft:x.tipMarginLeft||10},!0===H&&(e=F()),g=L(c),void 0!==e&&g.y(e.bbox().height+10),h.y(g.y()+g.bbox().height),c.forEach(W),c.forEach(z),c=c,l=0;l<c.length;l+=1)p[c[l].label]=l;c.forEach(E),c.forEach(T,c),c.forEach(M),!0===f&&(c.forEach(j),c.forEach(D),c.forEach(A),c.forEach(Q)),!1===f&&(c.forEach(Y),c.forEach(J),c.forEach(I),c.forEach(q))}}}();